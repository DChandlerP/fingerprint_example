<!DOCTYPE html>
<html lang="en" class="bg-gray-950 text-white">
<head>
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self'; 
    script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://unpkg.com https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; 
    style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; 
    font-src 'self' https://fonts.gstatic.com; 
    connect-src 'self' https://services.nvd.nist.gov https://api.first.org; 
    object-src 'none'; 
    frame-ancestors 'self'; 
    base-uri 'self';
">
<meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
<meta http-equiv="X-Content-Type-Options" content="nosniff">
<meta name="referrer-policy" content="strict-origin-when-cross-origin">
<meta http-equiv="Permissions-Policy" content="geolocation=(), midi=(), microphone=(), camera=(), magnetometer=(), gyroscope=(), payment=()">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Interactive Threat Model | D. Chandler Prince</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    html { font-family: 'Inter', sans-serif; }
    ::selection { background: #2563eb; color: #fff; }
    .mono { font-family: 'Roboto Mono', monospace; }
    .diagram-component { cursor: pointer; transition: all 0.2s ease-in-out; }
    .diagram-component:hover { transform: scale(1.05); filter: drop-shadow(0 0 10px #38bdf8); }
    .connector { stroke: #4b5563; stroke-width: 2px; }
    /* Ensure dropdown content is above other elements */
    .group .absolute {
      z-index: 50;
    }
  </style>
</head>
<body class="bg-gray-950 text-white min-h-screen flex flex-col">
  <!-- 
    NAV BAR FOR "GUIDES & CASE STUDIES" PAGES
    - "Home" is inactive.
    - "Guides & Case Studies" is ACTIVE.
    - "Tools & Demos" is inactive.
  -->
  <nav class="bg-gray-900 border-b border-gray-800 sticky top-0 z-40">
      <div class="w-full flex items-center justify-center px-6 py-3">
         <!-- Main navigation container -->
         <div class="flex flex-wrap justify-center space-x-4">
          
          <!-- Home Link (Inactive) -->
          <a href="index.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition">
            <span id="nav-home" class="mr-1"></span>Home
          </a>

          <!-- Guides & Case Studies Dropdown (ACTIVE) -->
          <div class="relative group">
            <!-- Dropdown Trigger -->
            <button class="flex items-center px-3 py-1 rounded text-white bg-blue-700 font-semibold transition">
              <span id="nav-guides-trigger" class="mr-1"></span>
              Guides & Case Studies
              <span id="nav-guides-chevron" class="ml-1"></span>
            </button>
            
            <!-- Dropdown Menu -->
            <div class="absolute left-0 mt-1 w-56 rounded-md shadow-lg bg-gray-800 ring-1 ring-black ring-opacity-5 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200">
              <div class="py-1" role="menu" aria-orientation="vertical">
                <a href="regulation.html" class="flex items-center px-4 py-2 text-sm text-blue-200 hover:bg-gray-700 hover:text-white" role="menuitem">
                  <span id="nav-regulation" class="mr-2"></span>Regulation (US/EU)
                </a>
                <a href="cloud.html" class="flex items-center px-4 py-2 text-sm text-blue-200 hover:bg-gray-700 hover:text-white" role="menuitem">
                  <span id="nav-cloud" class="mr-2"></span>Cloud
                </a>
                <a href="cyber_roadmap.html" class="flex items-center px-4 py-2 text-sm text-blue-200 hover:bg-gray-700 hover:text-white" role="menuitem">
                  <span id="nav-roadmap" class="mr-2"></span>Cyber Roadmap
                </a>
                <a href="phishing.html" class="flex items-center px-4 py-2 text-sm text-blue-200 hover:bg-gray-700 hover:text-white" role="menuitem">
                  <span id="nav-phishing" class="mr-2"></span>Phishing
                </a>
                <a href="sast.html" class="flex items-center px-4 py-2 text-sm text-blue-200 hover:bg-gray-700 hover:text-white" role="menuitem">
                  <span id="nav-sast" class="mr-2"></span>SAST
                </a>
                <a href="threatmodel.html" class="flex items-center px-4 py-2 text-sm text-blue-200 hover:bg-gray-700 hover:text-white" role="menuitem">
                  <span id="nav-threat" class="mr-2"></span>Threat Model
                </a>
              </div>
            </div>
          </div>

          <!-- Tools & Demos Dropdown (Inactive) -->
          <div class="relative group">
            <!-- Dropdown Trigger -->
            <button class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition">
              <span id="nav-tools-trigger" class="mr-1"></span>
              Tools & Demos
              <span id="nav-tools-chevron" class="ml-1"></span>
            </button>
            
            <!-- Dropdown Menu -->
            <div class="absolute left-0 mt-1 w-56 rounded-md shadow-lg bg-gray-800 ring-1 ring-black ring-opacity-5 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200">
              <div class="py-1" role="menu" aria-orientation="vertical">
                <a href="checklist.html" class="flex items-center px-4 py-2 text-sm text-blue-200 hover:bg-gray-700 hover:text-white" role="menuitem">
                  <span id="nav-checklist" class="mr-2"></span>Checklist
                </a>
                <a href="epssdemo.html" class="flex items-center px-4 py-2 text-sm text-blue-200 hover:bg-gray-700 hover:text-white" role="menuitem">
                  <span id="nav-epss" class="mr-2"></span>CVSS vs EPSS
                </a>
                <a href="encryption.html" class="flex items-center px-4 py-2 text-sm text-blue-200 hover:bg-gray-700 hover:text-white" role="menuitem">
                  <span id="nav-encryption" class="mr-2"></span>Encryption
                </a>
                <a href="fingerprint.html" class="flex items-center px-4 py-2 text-sm text-blue-200 hover:bg-gray-700 hover:text-white" role="menuitem">
                  <span id="nav-fp" class="mr-2"></span>Fingerprinting
                </a>
                <a href="jwt.html" class="flex items-center px-4 py-2 text-sm text-blue-200 hover:bg-gray-700 hover:text-white" role="menuitem">
                  <span id="nav-jwt" class="mr-2"></span>JWT Decoder
                </a>
                <a href="modcat.html" class="flex items-center px-4 py-2 text-sm text-blue-200 hover:bg-gray-700 hover:text-white" role="menuitem">
                  <span id="nav-modcat" class="mr-2"></span>PRS MODCAT
                </a>
                <a href="shamir.html" class="flex items-center px-4 py-2 text-sm text-blue-200 hover:bg-gray-700 hover:text-white" role="menuitem">
                  <span id="nav-shamir" class="mr-2"></span>Shamir's Visualizer
                </a>
                <a href="dashboard.html" class="flex items-center px-4 py-2 text-sm text-blue-200 hover:bg-gray-700 hover:text-white" role="menuitem">
                  <span id="nav-dashboard" class="mr-2"></span>Threat Intel
                </a>
              </div>
            </div>
          </div>
          
        </div>
      </div>
  </nav>

  <!-- Header -->
  <header class="bg-gradient-to-r from-blue-900 to-gray-900 py-10 px-4 text-center shadow-lg">
    <h1 class="text-4xl md:text-5xl font-bold mb-2 text-white tracking-tight">Interactive Threat Modeling</h1>
    <p class="max-w-3xl mx-auto text-gray-200 text-lg">
      Explore different methodologies for identifying, evaluating, and mitigating security threats in system design.
    </p>
  </header>

  <!-- Main Content -->
  <main class="flex-1 px-4 py-10 max-w-7xl mx-auto w-full space-y-12">
    <!-- STRIDE Example Section -->
    <section class="bg-gray-900 p-6 rounded-xl shadow-lg border border-gray-800">
      <div class="flex items-center gap-4 mb-4"><span id="stride-icon"></span><h2 class="text-2xl font-bold text-blue-300">STRIDE Threat Model Example</h2></div>
      <p class="text-gray-300 mb-6">This is a simplified Data Flow Diagram (DFD) for a User Authentication Service. Click on a component (like the User, Web App, or Database) to see potential threats based on the STRIDE methodology.</p>
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
        <!-- Diagram -->
        <div id="diagram-container" class="relative">
            <svg id="diagram" viewBox="0 0 400 300" class="w-full h-auto">
                <!-- Connectors -->
                <line class="connector" x1="60" y1="150" x2="160" y2="150" marker-end="url(#arrow)"></line>
                <line class="connector" x1="240" y1="150" x2="340" y2="150" marker-end="url(#arrow)"></line>
                <defs><marker id="arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#4b5563"></path></marker></defs>
                <!-- Components -->
                <g id="user" class="diagram-component"><rect x="10" y="125" width="100" height="50" fill="#1e3a8a" rx="10"></rect><text x="60" y="155" fill="white" text-anchor="middle" font-weight="bold">User</text></g>
                <g id="webapp" class="diagram-component"><rect x="150" y="125" width="100" height="50" fill="#1e3a8a" rx="10"></rect><text x="200" y="155" fill="white" text-anchor="middle" font-weight="bold">Web App</text></g>
                <g id="database" class="diagram-component"><rect x="290" y="125" width="100" height="50" fill="#1e3a8a" rx="10"></rect><text x="340" y="155" fill="white" text-anchor="middle" font-weight="bold">Database</text></g>
            </svg>
        </div>
        <!-- Threat Output -->
        <div id="threat-output" class="bg-gray-950 p-6 rounded-lg border border-gray-700 min-h-[300px]">
          <p class="text-gray-400 text-center">Click a diagram component to view its threats.</p>
        </div>
      </div>
    </section>

    <!-- PASTA Example Section -->
    <section class="bg-gray-900 p-6 rounded-xl shadow-lg border border-gray-800">
        <div class="flex items-center gap-4 mb-4"><span id="pasta-icon"></span><h2 class="text-2xl font-bold text-blue-300">PASTA Threat Model Example</h2></div>
        <p class="text-gray-300 mb-6">PASTA (Process for Attack Simulation and Threat Analysis) is a risk-centric methodology that aligns business objectives with security requirements. It involves seven stages to provide a deeper, attacker-centric view of threats.</p>
        <div class="space-y-4">
            <div class="bg-gray-800 p-4 rounded-lg"><h3 class="font-semibold text-lg text-blue-300">Stage I: Define Business Objectives</h3><p class="text-gray-400 text-sm">Identify the primary goals of the application. For our User Authentication Service, objectives are: Securely authenticate users, protect Personally Identifiable Information (PII), and maintain 99.9% uptime.</p></div>
            <div class="bg-gray-800 p-4 rounded-lg"><h3 class="font-semibold text-lg text-blue-300">Stage II: Define the Technical Scope</h3><p class="text-gray-400 text-sm">Map out the technologies in use: A React frontend, a Node.js backend API, a PostgreSQL database, all hosted on AWS. Data flows over HTTPS.</p></div>
            <div class="bg-gray-800 p-4 rounded-lg"><h3 class="font-semibold text-lg text-blue-300">Stage III: Application Decomposition</h3><p class="text-gray-400 text-sm">Break down the application into its core components and trust boundaries, similar to the DFD in the STRIDE example. Identify entry points (login forms, API endpoints) and data stores (user database, session store).</p></div>
            <div class="bg-gray-800 p-4 rounded-lg"><h3 class="font-semibold text-lg text-blue-300">Stage IV: Threat Analysis</h3><p class="text-gray-400 text-sm">Analyze known vulnerabilities and threat intelligence relevant to the tech stack (e.g., known Node.js library vulnerabilities, common attacks against PostgreSQL).</p></div>
            <div class="bg-gray-800 p-4 rounded-lg"><h3 class="font-semibold text-lg text-blue-300">Stage V: Vulnerability & Weakness Analysis</h3><p class="text-gray-400 text-sm">Correlate application components with known threats. For example, identify a lack of rate limiting on the login endpoint (a weakness) and correlate it with the threat of credential stuffing (from Stage IV).</p></div>
            <div class="bg-gray-800 p-4 rounded-lg"><h3 class="font-semibold text-lg text-blue-300">Stage VI: Attack Modeling</h3><p class="text-gray-400 text-sm">Simulate attacks based on the vulnerabilities identified. Create an attack tree for an attacker to achieve the goal of "Steal User Credentials". This might involve exploiting a SQL injection flaw found in Stage V.</p></div>
            <div class="bg-gray-800 p-4 rounded-lg"><h3 class="font-semibold text-lg text-blue-300">Stage VII: Risk & Impact Analysis</h3><p class="text-gray-400 text-sm">Calculate the business impact of a successful attack. A credential stuffing attack could lead to account takeovers, resulting in reputational damage and financial loss. The impact of a PII breach would be high due to regulatory fines (e.g., GDPR). This stage helps prioritize which threats to fix first based on business risk.</p></div>
        </div>
    </section>

    <!-- Comparison Section -->
    <section class="bg-gray-900 p-6 rounded-xl shadow-lg border border-gray-800">
        <div class="flex items-center gap-4 mb-4"><span id="compare-icon"></span><h2 class="text-2xl font-bold text-blue-300">Choosing the Right Methodology</h2></div>
        <p class="text-gray-300 mb-6">Different methodologies excel in different contexts. Here’s a comparison to help you decide which approach is best for your needs.</p>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-gray-800 p-4 rounded-lg"><h3 class="font-semibold text-lg text-green-300 flex items-center gap-2"><span id="stride-icon2"></span>STRIDE</h3><p class="text-gray-400 mt-2">A mnemonic-based approach focused on identifying common software security threats.</p><p class="mt-3 text-sm"><strong class="text-gray-200">Best for:</strong> Developer-focused, systematic brainstorming. Great for initial analysis of applications and identifying a broad range of common vulnerabilities.</p></div>
            <div class="bg-gray-800 p-4 rounded-lg"><h3 class="font-semibold text-lg text-green-300 flex items-center gap-2"><span id="pasta-icon2"></span>PASTA</h3><p class="text-gray-400 mt-2">A seven-stage, risk-centric methodology that aligns security with business objectives.</p><p class="mt-3 text-sm"><strong class="text-gray-200">Best for:</strong> Mature organizations or critical applications where aligning security effort with business impact is key. It is comprehensive but more time-intensive.</p></div>
            <div class="bg-gray-800 p-4 rounded-lg"><h3 class="font-semibold text-lg text-green-300 flex items-center gap-2"><span id="vast-icon"></span>VAST</h3><p class="text-gray-400 mt-2">A methodology focused on integrating threat modeling into Agile and DevOps pipelines.</p><p class="mt-3 text-sm"><strong class="text-gray-200">Best for:</strong> Teams practicing CI/CD and DevOps. It provides actionable outputs for developers and scales across an organization.</p></div>
            <div class="bg-gray-800 p-4 rounded-lg"><h3 class="font-semibold text-lg text-green-300 flex items-center gap-2"><span id="linddun-icon"></span>LINDDUN</h3><p class="text-gray-400 mt-2">A privacy-focused methodology that identifies privacy-specific threats.</p><p class="mt-3 text-sm"><strong class="text-gray-200">Best for:</strong> Applications that handle Personally Identifiable Information (PII) or need to comply with privacy regulations like GDPR or CCPA.</p></div>
            <div class="bg-gray-800 p-4 rounded-lg"><h3 class="font-semibold text-lg text-green-300 flex items-center gap-2"><span id="attacktree-icon"></span>Attack Trees</h3><p class="text-gray-400 mt-2">A visual method of breaking down an attacker's goal into smaller, achievable steps.</p><p class="mt-3 text-sm"><strong class="text-gray-200">Best for:</strong> Deep-diving into specific, high-risk threats. Excellent for visualizing complex attack paths and identifying potential mitigation points.</p></div>
            <div class="bg-gray-800 p-4 rounded-lg"><h3 class="font-semibold text-lg text-green-300 flex items-center gap-2"><span id="dread-icon"></span>DREAD</h3><p class="text-gray-400 mt-2">A risk-rating model used to prioritize threats (Damage, Reproducibility, Exploitability, Affected users, Discoverability).</p><p class="mt-3 text-sm"><strong class="text-gray-200">Best for:</strong> Quickly ranking and prioritizing threats found using another methodology like STRIDE. It's less of a full methodology and more of a prioritization tool.</p></div>
        </div>
    </section>
  </main>
  
  <footer class="bg-gray-900 text-gray-400 text-center py-4 mt-8 rounded-t-xl shadow-inner">
    © 2025 D. Chandler Prince
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- 1. Page-Specific Logic ---
        const threatData = {
            user: {
                name: 'User',
                threats: [
                    { type: 'Spoofing', scenario: 'An attacker impersonates a legitimate user by stealing their credentials through a phishing attack.', mitigation: 'Implement Multi-Factor Authentication (MFA). Educate users on phishing.' },
                    { type: 'Tampering', scenario: 'A malicious user attempts to tamper with data sent from their client, such as changing their user ID in a hidden form field.', mitigation: 'Perform all validation and authorization checks on the server-side, never trust client-side data.' },
                    { type: 'Repudiation', scenario: 'A user performs a critical action (e.g., deleting data) and later claims they never did it.', mitigation: 'Implement comprehensive audit logging for all sensitive actions, including user ID, timestamp, and IP address.' },
                ]
            },
            webapp: {
                name: 'Web App',
                threats: [
                    { type: 'Information Disclosure', scenario: 'An error message reveals sensitive system information, such as a database schema or internal file paths.', mitigation: 'Configure the server to show generic error messages to users and log detailed errors internally.' },
                    { type: 'Denial of Service', scenario: 'An attacker floods the login endpoint with requests, overwhelming the server and preventing legitimate users from logging in.', mitigation: 'Implement rate limiting and consider a Web Application Firewall (WAF) to block malicious IPs.' },
                    { type: 'Elevation of Privilege', scenario: 'A flaw in session management allows a regular user to access administrative endpoints by guessing URLs.', mitigation: 'Enforce strict, role-based access control (RBAC) on all server-side endpoints.' },
                ]
            },
            database: {
                name: 'Database',
                threats: [
                    { type: 'Spoofing', scenario: 'An attacker uses stolen application credentials from a configuration file to connect to the database directly.', mitigation: 'Use a secrets management system (e.g., AWS Secrets Manager, HashiCorp Vault) instead of hardcoding credentials.' },
                    { type: 'Tampering', scenario: 'A SQL Injection vulnerability allows an attacker to modify or delete records in the database.', mitigation: 'Use parameterized queries (prepared statements) for all database interactions.' },
                    { type: 'Information Disclosure', scenario: 'The database is not encrypted at rest, and an attacker who gains access to the server\'s file system can read the raw data files.', mitigation: 'Enable Transparent Data Encryption (TDE) on the database server.' },
                ]
            }
        };

        const diagram = document.getElementById('diagram');
        const threatOutput = document.getElementById('threat-output');

        function displayThreats(componentId) {
            const data = threatData[componentId];
            if (!data) return;

            let html = `<h4 class="text-lg font-semibold text-blue-300 mb-3">Threats for: ${data.name}</h4>`;
            
            data.threats.forEach(threat => {
                html += `
                    <div class="bg-gray-800 p-4 rounded-lg border border-gray-700 mb-3">
                        <p class="font-bold text-blue-300"><span class="font-mono bg-blue-900 px-2 py-1 rounded text-sm">${threat.type[0]}</span> ${threat.type}</p>
                        <p class="mt-2 text-gray-300"><span class="font-semibold text-gray-100">Scenario:</span> ${threat.scenario}</p>
                        <p class="mt-2 text-gray-300"><span class="font-semibold text-gray-100">Mitigation:</span> ${threat.mitigation}</p>
                    </div>
                `;
            });
            threatOutput.innerHTML = html;
        }

        if(diagram) {
            diagram.addEventListener('click', (e) => {
                const component = e.target.closest('.diagram-component');
                if (component) {
                    displayThreats(component.id);
                }
            });
        }

        // --- 2. Render ALL Icons (Nav + Page) ---
        if (window.lucide) {
            lucide.createIcons({
            icons: {
                // All Nav Icons
                'nav-home': lucide.Home,
                'nav-guides-trigger': lucide.BookOpen,
                'nav-tools-trigger': lucide.Briefcase,
                'nav-guides-chevron': lucide.ChevronDown,
                'nav-tools-chevron': lucide.ChevronDown,
                'nav-cloud': lucide.Cloud,
                'nav-roadmap': lucide.Map,
                'nav-phishing': lucide.Fish,
                'nav-sast': lucide.FileSearch,
                'nav-threat': lucide.ShieldAlert,
                'nav-checklist': lucide.ListChecks,
                'nav-epss': lucide.Activity,
                'nav-encryption': lucide.Lock,
                'nav-fp': lucide.Fingerprint,
                'nav-jwt': lucide.KeyRound,
                'nav-modcat': lucide.Guitar,
                'nav-shamir': lucide.Share2,
                'nav-dashboard': lucide.LayoutDashboard,

                // Page-specific icons
                'stride-icon': lucide.Target, 
                'pasta-icon': lucide.ClipboardList, 
                'compare-icon': lucide.Scaling,
                'stride-icon2': lucide.Target, 
                'pasta-icon2': lucide.ClipboardList, 
                'vast-icon': lucide.GitMerge, 
                'linddun-icon': lucide.ShieldQuestion, 
                'attacktree-icon': lucide.GitFork, 
                'dread-icon': lucide.Calculator
            },
            attrs: { color: "#38bdf8", size: 24, strokeWidth: 2 }
            });
        }

        // --- 3. Add Nav Dropdown Logic ---
        const dropdownButtons = document.querySelectorAll('.group > button');
        dropdownButtons.forEach(button => {
            button.addEventListener('click', (e) => {
            const dropdownMenu = e.currentTarget.nextElementSibling;
            // Close all other open dropdowns
            document.querySelectorAll('.group .absolute').forEach(menu => {
                if (menu !== dropdownMenu) {
                menu.classList.add('opacity-0', 'invisible');
                menu.classList.remove('opacity-100', 'visible');
                }
            });
            // Toggle the current dropdown
            dropdownMenu.classList.toggle('opacity-0');
            dropdownMenu.classList.toggle('invisible');
            dropdownMenu.classList.toggle('opacity-100');
            dropdownMenu.classList.toggle('visible');
            });
        });

        // Close dropdowns if clicking outside
        window.addEventListener('click', (e) => {
            if (!e.target.closest('.group')) {
            document.querySelectorAll('.group .absolute').forEach(menu => {
                menu.classList.add('opacity-0', 'invisible');
                menu.classList.remove('opacity-100', 'visible');
            });
            }
        });
    });
  </script>
</body>
</html>

