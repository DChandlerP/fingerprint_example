<!DOCTYPE html>
<html lang="en" class="bg-gray-950 text-white">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Interactive Threat Model | D. Chandler Prince</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    html { font-family: 'Inter', sans-serif; }
    ::selection { background: #2563eb; color: #fff; }
    .diagram-component {
      cursor: pointer;
      transition: all 0.2s ease-in-out;
    }
    .diagram-component rect {
      stroke: #38bdf8; /* sky-500 */
      stroke-width: 2;
      fill: #1f2937; /* gray-800 */
    }
    .diagram-component text {
      fill: #e5e7eb; /* gray-200 */
      font-weight: 600;
    }
    .diagram-component:hover rect, .diagram-component.active rect {
      fill: #3b82f6; /* blue-500 */
      stroke: #fff;
    }
    .diagram-component:hover text, .diagram-component.active text {
      fill: #fff;
    }
  </style>
</head>
<body class="bg-gray-950 text-white min-h-screen flex flex-col">
  <!-- Navigation Bar -->
  <nav class="bg-gray-900 border-b border-gray-800 sticky top-0 z-30">
    <div class="w-full flex items-center justify-between px-4 py-3">
      <div class="flex items-center space-x-3">
        <a href="https://www.linkedin.com/in/chandler-prince-b53b1427/" target="_blank" rel="noopener" class="text-blue-400 hover:text-blue-300" title="LinkedIn">
          <span id="nav-linkedin" class="w-6 h-6"></span>
        </a>
        <a href="https://github.com/DChandlerP/" target="_blank" rel="noopener" class="text-blue-400 hover:text-blue-300" title="GitHub">
          <span id="nav-github" class="w-6 h-6"></span>
        </a>
      </div>
       <div class="flex flex-wrap justify-center space-x-2">
        <a href="index.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-home" class="mr-1"></span>Home</a>
        <a href="cloud.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-cloud" class="mr-1"></span>Cloud Explorer</a>
        <a href="sast.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-sast" class="mr-1"></span>SAST Guide</a>
        <a href="threatmodel.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-threat" class="mr-1"></span>Threat Model</a>
        <a href="checklist.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-checklist" class="mr-1"></span>Checklist Generator</a>
        <a href="jwt.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-jwt" class="mr-1"></span>JWT Decoder</a>
        <a href="fingerprint.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-fp" class="mr-1"></span>Fingerprint Demo</a>
        <a href="epssdemo.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-epss" class="mr-1"></span>EPSS Comparator</a>
        <a href="dashboard.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-dashboard" class="mr-1"></span>Threat Dashboard</a>
        <a href="modcat.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-modcat" class="mr-1"></span>MODCAT Decoder</a>
      </div>
    </div>
  </nav>

  <!-- Header -->
  <header class="bg-gradient-to-r from-blue-900 to-gray-900 py-10 px-4 text-center shadow-lg">
    <h1 class="text-4xl md:text-5xl font-bold mb-2 text-white tracking-tight">Interactive Threat Model: E-Commerce API</h1>
    <p class="max-w-2xl mx-auto text-gray-200 text-lg md:text-xl">
      A hands-on walk-through of identifying security threats using the STRIDE framework. Click a component in the diagram to analyze its threats.
    </p>
  </header>

  <main class="flex-1 px-4 py-10 max-w-5xl mx-auto w-full space-y-8">
    <!-- Interactive Diagram -->
    <section id="diagram-section" class="bg-gray-900 p-6 rounded-xl shadow-lg">
        <h3 class="text-2xl font-semibold text-blue-400 mb-4 text-center">System Architecture Diagram</h3>
        <div id="diagram-container" class="w-full flex justify-center">
            <svg id="architecture-diagram" viewBox="0 0 800 400" class="max-w-full">
                <!-- Components -->
                <g id="user" class="diagram-component">
                    <rect x="50" y="160" width="120" height="60" rx="8"></rect>
                    <text x="110" y="195" text-anchor="middle">User</text>
                </g>
                <g id="api-gateway" class="diagram-component">
                    <rect x="250" y="160" width="120" height="60" rx="8"></rect>
                    <text x="310" y="195" text-anchor="middle">API Gateway</text>
                </g>
                <g id="auth-service" class="diagram-component">
                    <rect x="450" y="70" width="120" height="60" rx="8"></rect>
                    <text x="510" y="105" text-anchor="middle">Auth Service</text>
                </g>
                <g id="product-service" class="diagram-component">
                    <rect x="450" y="160" width="120" height="60" rx="8"></rect>
                    <text x="510" y="195" text-anchor="middle">Product Service</text>
                </g>
                <g id="customer-db" class="diagram-component">
                    <rect x="630" y="70" width="120" height="60" rx="8"></rect>
                    <text x="690" y="105" text-anchor="middle">Customer DB</text>
                </g>

                <!-- Connectors -->
                <line x1="170" y1="190" x2="250" y2="190" stroke="#4b5563" stroke-width="2" />
                <line x1="370" y1="190" x2="450" y2="190" stroke="#4b5563" stroke-width="2" />
                <line x1="370" y1="170" x2="450" y2="100" stroke="#4b5563" stroke-width="2" />
                <line x1="570" y1="100" x2="630" y2="100" stroke="#4b5563" stroke-width="2" />
            </svg>
        </div>
        <div class="mt-4 text-center text-gray-400 text-sm">
          <p><span class="font-bold text-blue-300">STRIDE:</span> <span class="font-semibold">S</span>poofing, <span class="font-semibold">T</span>ampering, <span class="font-semibold">R</span>epudiation, <span class="font-semibold">I</span>nformation Disclosure, <span class="font-semibold">D</span>enial of Service, <span class="font-semibold">E</span>levation of Privilege</p>
        </div>
    </section>

    <!-- Threat Analysis -->
    <section id="analysis-section" class="bg-gray-900 p-6 rounded-xl shadow-lg min-h-[200px]">
        <h3 class="text-2xl font-semibold text-blue-400 mb-4">Threat Analysis</h3>
        <div id="threat-output" class="space-y-4">
             <p class="text-center py-8 text-gray-500">Click a component in the diagram to see its potential threats.</p>
        </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-900 text-gray-400 text-center py-4 mt-8 rounded-t-xl shadow-inner">
    Â© 2025 D. Chandler Prince
  </footer>

  <script>
    const threatData = {
      user: {
        name: "User",
        threats: [
          { type: "Spoofing", scenario: "An attacker impersonates a legitimate user by stealing their credentials through a phishing attack.", mitigation: "Enforce Multi-Factor Authentication (MFA) and educate users about phishing risks." },
          { type: "Repudiation", scenario: "A legitimate user denies performing an action (e.g., a large purchase), claiming their account was compromised.", mitigation: "Implement comprehensive and immutable audit logs for all sensitive user actions." }
        ]
      },
      "api-gateway": {
        name: "API Gateway",
        threats: [
          { type: "Denial of Service", scenario: "An attacker floods the gateway with a massive volume of requests, overwhelming it and making the service unavailable for legitimate users.", mitigation: "Implement rate limiting, throttling, and use a Web Application Firewall (WAF) like Cloud Armor or Akamai." },
          { type: "Information Disclosure", scenario: "Overly verbose error messages from the gateway reveal internal system details that could aid an attacker.", mitigation: "Configure generic, non-descriptive error messages for production environments." },
          { type: "Tampering", scenario: "A Man-in-the-Middle (MITM) attacker intercepts and modifies requests between the user and the gateway.", mitigation: "Enforce HTTPS/TLS across all connections to encrypt data in transit." }
        ]
      },
      "auth-service": {
        name: "Authentication Service",
        threats: [
          { type: "Spoofing", scenario: "An attacker bypasses authentication using stolen session tokens or JWTs.", mitigation: "Use short-lived tokens, implement secure token storage on clients, and add a token revocation mechanism." },
          { type: "Denial of Service", scenario: "An attacker launches a credential stuffing attack, locking out legitimate user accounts due to failed login attempts.", mitigation: "Implement account lockout policies, rate limiting, and use a captcha after several failed attempts." },
          { type: "Elevation of Privilege", scenario: "A vulnerability in the service allows a regular user to generate a token with administrative privileges.", mitigation: "Follow the principle of least privilege in token generation; conduct regular code reviews and security testing." }
        ]
      },
      "product-service": {
        name: "Product Service",
        threats: [
          { type: "Elevation of Privilege", scenario: "An Insecure Direct Object Reference (IDOR) vulnerability allows a user to access or modify data for a product they don't own by manipulating an ID in the URL.", mitigation: "Implement robust authorization checks on every request to ensure the user has permission to access the requested resource." },
          { type: "Tampering", scenario: "An attacker exploits a vulnerability to change the price of a product before adding it to their cart.", mitigation: "Validate all business logic on the server-side; treat all client-side data as untrusted." }
        ]
      },
      "customer-db": {
        name: "Customer Database",
        threats: [
          { type: "Information Disclosure", scenario: "An attacker exploits a SQL injection vulnerability to dump the entire customer table, exposing Personally Identifiable Information (PII).", mitigation: "Use parameterized queries/prepared statements, and encrypt sensitive data columns at rest." },
          { type: "Tampering", scenario: "An attacker gains access and alters customer records or deletes data.", mitigation: "Enforce strict, role-based access controls on the database; implement regular backups and point-in-time recovery." },
          { type: "Denial of Service", scenario: "An attacker runs a computationally expensive query that locks up the database, preventing legitimate access.", mitigation: "Implement query timeouts, restrict database user permissions, and monitor database performance." }
        ]
      }
    };

    const diagram = document.getElementById('architecture-diagram');
    const threatOutput = document.getElementById('threat-output');
    const components = diagram.querySelectorAll('.diagram-component');

    function displayThreats(componentId) {
        // Remove active class from all components
        components.forEach(c => c.classList.remove('active'));
        
        const activeComponent = document.getElementById(componentId);
        if (activeComponent) {
            activeComponent.classList.add('active');
        }

        const data = threatData[componentId];
        if (!data) {
            threatOutput.innerHTML = `<p class="text-center py-8 text-gray-500">No threat data available for this component.</p>`;
            return;
        }

        let html = `<h4 class="text-xl font-semibold text-blue-300 mb-3">Threats for: ${data.name}</h4>`;
        
        data.threats.forEach(threat => {
            html += `
                <div class="bg-gray-800 p-4 rounded-lg border border-gray-700">
                    <p class="font-bold text-blue-300"><span class="font-mono bg-blue-900 px-2 py-1 rounded text-sm">${threat.type[0]}</span> ${threat.type}</p>
                    <p class="mt-2 text-gray-300"><span class="font-semibold text-gray-100">Scenario:</span> ${threat.scenario}</p>
                    <p class="mt-2 text-gray-300"><span class="font-semibold text-gray-100">Mitigation:</span> ${threat.mitigation}</p>
                </div>
            `;
        });
        threatOutput.innerHTML = html;
    }

    diagram.addEventListener('click', (e) => {
        const component = e.target.closest('.diagram-component');
        if (component) {
            displayThreats(component.id);
        }
    });

    lucide.createIcons({
      icons: {
        'nav-home': lucide.Home,
        'nav-threat': lucide.ShieldAlert,
        'nav-checklist': lucide.ListChecks,
        'nav-jwt': lucide.KeyRound,
        'nav-fp': lucide.Fingerprint,
        'nav-epss': lucide.Activity,
        'nav-modcat': lucide.Guitar,
        'nav-linkedin': lucide.Linkedin,
        'nav-github': lucide.Github
      },
      attrs: {
        color: "#38bdf8",
        size: 24,
        strokeWidth: 2
      }
    });
  </script>
</body>
</html>
