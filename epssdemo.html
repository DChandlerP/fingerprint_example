<!DOCTYPE html>
<html lang="en">

<head>
    <!-- 
      This Content Security Policy is a bit more permissive to allow necessary external resources.
      - 'unsafe-inline' is used for scripts and styles, which is common but less secure than using nonces or hashes.
      - connect-src is limited to the specific APIs we need.
    -->
    <meta http-equiv="Content-Security-Policy" content="
    default-src 'self'; 
    script-src 'self' 'unsafe-inline'; 
    style-src 'self' 'unsafe-inline'; 
    connect-src 'self' https://services.nvd.nist.gov https://api.first.org; 
    object-src 'none'; 
    frame-ancestors 'self'; 
    base-uri 'self';
">
    <meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta name="referrer-policy" content="strict-origin-when-cross-origin">
    <meta http-equiv="Permissions-Policy"
        content="geolocation=(), midi=(), microphone=(), camera=(), magnetometer=(), gyroscope=(), payment=()">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVSS vs. EPSS Comparator</title>
</head>

<body hidden class="bg-gray-950 text-white min-h-screen flex flex-col">

    <site-nav></site-nav>

    <main class="flex-1 px-4 py-10 max-w-7xl mx-auto w-full">
        <header class="text-center mb-10">
            <h1 class="text-4xl md:text-5xl font-bold text-white mb-2">CVSS vs. EPSS Comparator</h1>
            <p class="text-xl text-blue-300">Compare real-world exploitability with CVSS severity scores.</p>
        </header>

        <section class="mb-8 grid gap-6 md:grid-cols-2 max-w-5xl mx-auto">
            <div class="bg-gray-900 rounded-xl shadow-lg p-5 border border-gray-800">
                <h3 class="font-semibold text-lg text-yellow-400 mb-1">What is CVSS?</h3>
                <p class="text-sm text-gray-300">The <strong>Common Vulnerability Scoring System (CVSS)</strong> rates
                    severity on a scale of 0-10. It answers: "How bad would this be if it were exploited?" It considers
                    impact and exploitability factors.</p>
            </div>
            <div class="bg-gray-900 rounded-xl shadow-lg p-5 border border-gray-800">
                <h3 class="font-semibold text-lg text-blue-400 mb-1">What is EPSS?</h3>
                <p class="text-sm text-gray-300">The <strong>Exploit Prediction Scoring System (EPSS)</strong> estimates
                    the probability (0-100%) that a vulnerability will be exploited in the wild in the next 30 days. It
                    answers: "How likely is this to be exploited?"</p>
            </div>
        </section>

        <!-- Input Section -->
        <section class="mb-8 flex flex-col sm:flex-row gap-4 max-w-5xl mx-auto">
            <input type="text" id="vulnId"
                class="flex-grow bg-gray-800 text-white border-2 border-gray-700 rounded-lg px-4 py-3 text-lg focus:border-blue-400 focus:ring-0 outline-none transition"
                placeholder="Enter CVE ID (e.g., CVE-2024-3094)" value="CVE-2022-41741">
            <button id="fetchButton"
                class="bg-blue-700 text-white font-bold px-8 py-3 rounded-lg text-lg hover:bg-blue-600 transition-colors duration-200">
                Compare Data
            </button>
        </section>

        <!-- Results container -->
        <div id="results-container" class="max-w-5xl mx-auto"></div>

    </main>

    <site-footer></site-footer>

    <script type="module" src="/epssdemo.js"></script>
    <script type="module" src="/main.js"></script>
</body>

</html>