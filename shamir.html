<!DOCTYPE html>
<html lang="en" class="invisible">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shamir's Secret Sharing Visualizer</title>
</head>

<body hidden class="bg-gray-950 text-gray-200 min-h-screen flex flex-col font-sans">
    <!-- Adjusted body classes for nav -->
    <site-nav></site-nav>

    <!-- Main Content Wrapper -->
    <main class="flex-1 flex items-center justify-center p-4 sm:p-8">
        <div class="w-full max-w-7xl mx-auto bg-gray-900 shadow-2xl rounded-2xl p-6 sm:p-8 border border-gray-800">
            <header class="mb-6 pb-4 border-b border-gray-800">
                <h1 class="text-3xl sm:text-4xl font-bold text-white text-center">Shamir's Secret Sharing Visualizer</h1>
                <p class="text-center text-blue-300 mt-2">Visualize how a secret can be split and reconstructed using polynomials.</p>
            </header>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Left Column: Controls and Data -->
                <div class="flex flex-col space-y-6">
                    <!-- 1. Configuration -->
                    <div class="bg-gray-800 p-5 rounded-lg border border-gray-700">
                        <h2 class="text-xl font-semibold mb-4 text-blue-400">1. Configuration</h2>
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                            <div>
                                <label for="secret" class="block text-gray-300 text-sm font-bold mb-2">Secret (S)</label>
                                <input type="number" id="secret" value="150" class="shadow-sm appearance-none bg-gray-700 border border-gray-600 rounded w-full py-2 px-3 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label for="threshold" class="block text-gray-300 text-sm font-bold mb-2">Threshold (k)</label>
                                <input type="number" id="threshold" value="3" min="2" class="shadow-sm appearance-none bg-gray-700 border border-gray-600 rounded w-full py-2 px-3 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label for="totalShares" class="block text-gray-300 text-sm font-bold mb-2">Total Shares (n)</label>
                                <input type="number" id="totalShares" value="6" min="2" class="shadow-sm appearance-none bg-gray-700 border border-gray-600 rounded w-full py-2 px-3 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                        <button id="generateBtn" class="mt-4 w-full bg-blue-700 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline transition duration-300">
                            Generate Polynomial & Shares
                        </button>
                    </div>

                    <!-- 2. Shares Selection -->
                    <div class="flex-grow flex flex-col">
                        <div class="flex justify-between items-end mb-2">
                            <h2 class="text-xl font-semibold text-blue-400">2. Select Shares</h2>
                            <span id="selectionStatus" class="text-sm font-mono text-gray-400">Selected: 0</span>
                        </div>
                        <div id="sharesContainer" class="grid grid-cols-2 sm:grid-cols-3 gap-3 bg-gray-950 p-4 rounded-xl border border-gray-700 min-h-[150px] content-start">
                            <p class="col-span-full text-gray-500 text-sm text-center py-10">Generate a polynomial to see shares.</p>
                        </div>
                        <p class="text-xs text-gray-500 mt-2 text-center">Click shares to toggle selection. You need at least <span id="thresholdDisplay" class="font-bold text-gray-300">k</span> shares.</p>
                    </div>

                    <!-- 3. Reconstruction -->
                    <div class="bg-gray-800 p-5 rounded-lg border border-gray-700">
                        <h2 class="text-xl font-semibold mb-4 text-blue-400">3. Reconstruct Secret</h2>
                        <button id="reconstructBtn" class="w-full bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline transition duration-300" disabled>
                            Reconstruct Secret
                        </button>
                        <div id="reconstructionResult" class="mt-4 text-lg text-center font-bold p-3 rounded-lg bg-gray-700 text-gray-200 min-h-[50px]">
                            Result will be shown here.
                        </div>
                    </div>
                </div>

                <!-- Right Column: Visualization -->
                <div class="flex flex-col items-center justify-center bg-gray-800 p-4 rounded-lg border border-gray-700 h-fit sticky top-4">
                    <h2 class="text-xl font-semibold mb-4 text-blue-400">Polynomial Visualization</h2>
                    <canvas id="polynomialCanvas" class="w-full h-auto aspect-video border border-gray-600 rounded-md bg-gray-950"></canvas>
                    <div class="mt-4 text-sm text-gray-400 flex justify-center space-x-4">
                        <span><span class="inline-block w-3 h-3 bg-red-500 rounded-full"></span> Secret</span>
                        <span><span class="inline-block w-3 h-3 bg-blue-500 rounded-full"></span> Available Share</span>
                        <span><span class="inline-block w-3 h-3 bg-green-500 rounded-full"></span> Selected Share</span>
                    </div>
                    <!-- Dynamic Explanation Log -->
                    <div id="explanationLog" class="mt-4 w-full bg-indigo-900/40 p-4 rounded-lg border border-indigo-700 text-indigo-200 text-sm">
                        Welcome! Press "Generate" to begin.
                    </div>
                </div>
            </div>

            <!-- Explanatory Text Section -->
            <div class="mt-10 pt-6 border-t border-gray-800 space-y-8">
                <div class="text-center">
                    <h2 class="text-3xl font-bold text-white">How It Works: The Intuition Behind the Magic</h2>
                    <p class="mt-2 max-w-3xl mx-auto text-gray-400">This tool demonstrates Shamir's Secret Sharing, a cryptographic algorithm by Adi Shamir. It solves a critical problem: how do you secure vital information without a single point of failure?</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- The Problem Card -->
                    <div class="bg-gray-800 p-6 rounded-xl border border-amber-500/50">
                        <h4 class="text-xl font-semibold text-amber-400 mb-3">The Problem: The "Key Under the Doormat" Dilemma</h4>
                        <div class="space-y-3 text-gray-300">
                            <p>Imagine a treasure chest key. Hiding it creates a single point of failure. If you lose it, or the person holding it is unavailable, the treasure is lost. Cutting it in half doesn't work.</p>
                            <p>Shamir's scheme splits a "key" (the secret number) into multiple parts, called <strong>shares</strong>, with two special properties:</p>
                            <ol class="list-decimal list-inside space-y-1 pl-2">
                                <li>A specific number of shares (the <strong>threshold `k`</strong>) must combine to recreate the key.</li>
                                <li>Anyone with fewer shares has absolutely no information about the key.</li>
                            </ol>
                        </div>
                    </div>

                    <!-- The Solution Card -->
                    <div class="bg-gray-800 p-6 rounded-xl border border-sky-500/50">
                        <h4 class="text-xl font-semibold text-sky-400 mb-3">The Solution: High School Math!</h4>
                        <div class="space-y-3 text-gray-300">
                            <p>The solution uses a simple geometric fact: <span class="font-semibold text-white">"It takes two points to define a unique line, three points to define a unique parabola, and so on."</span></p>
                            <ul class="list-disc list-inside space-y-1 pl-2">
                                <li><strong>The Secret is a Point:</strong> The secret number is the y-intercept of a graph (the red dot at x=0).</li>
                                <li><strong>A Random Curve is Drawn:</strong> The algorithm generates a random polynomial (a curve) of degree `k-1` that passes through the secret point.</li>
                                <li><strong>Shares are Other Points:</strong> The shares given out are just other points on that same secret curve.</li>
                            </ul>
                            <p>To find the secret, you just need enough points (`k`) to uniquely identify the curve. With too few points, the secret is perfectly hidden among infinite possibilities.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer - Removed for standalone app feel -->

    <script type="module" src="/shamir.js"></script>
    <script type="module" src="/main.js"></script>
</body>

</html>