<!DOCTYPE html>
<html lang="en" class="bg-gray-950 text-white">
<head>
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self'; 
    script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://unpkg.com https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; 
    style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; 
    font-src 'self' https://fonts.gstatic.com; 
    connect-src 'self' https://services.nvd.nist.gov https://api.first.org; 
    object-src 'none'; 
    frame-ancestors 'self'; 
    base-uri 'self';
">
<meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
<meta http-equiv="X-Content-Type-Options" content="nosniff">
<meta name="referrer-policy" content="strict-origin-when-cross-origin">
<meta http-equiv="Permissions-Policy" content="geolocation=(), midi=(), microphone=(), camera=(), magnetometer=(), gyroscope=(), payment=()">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Investigating SAST Findings | D. Chandler Prince</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  
  <style>
    html { font-family: 'Inter', sans-serif; }
    ::selection { background: #2563eb; color: #fff; }
    .code-block {
      background-color: #030712; /* gray-950 */
      border-radius: 0.5rem;
      border: 1px solid #374151; /* border-gray-700 */
      padding: 1rem;
      font-family: 'Menlo', 'Consolas', monospace;
      font-size: 0.875rem; /* text-sm */
      overflow-x: auto;
      color: #e5e7eb; /* gray-200 */
    }
    .code-block code {
        white-space: pre;
    }
  </style>
</head>
<body class="bg-gray-950 text-white min-h-screen flex flex-col">
  <!-- Navigation Bar -->
<nav class="bg-gray-900 border-b border-gray-800 sticky top-0 z-30">
      <div class="w-full flex items-center justify-center px-6 py-3">
         <div class="flex flex-wrap justify-center space-x-4">
          <a href="index.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-home" class="mr-1"></span>Home</a>
          <a href="phishing.html" class="flex items-center px-3 py-1 rounded text-white bg-blue-700 font-semibold transition"><span id="nav-phishing" class="mr-1"></span>Phishing</a>
          <a href="cloud.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-cloud" class="mr-1"></span>Cloud</a>
          <a href="sast.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-sast" class="mr-1"></span>SAST</a>
          <a href="threatmodel.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-threat" class="mr-1"></span>Threat Model</a>
          <a href="checklist.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-checklist" class="mr-1"></span>Checklist</a>
          <a href="jwt.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-jwt" class="mr-1"></span>JWT Decoder</a>
          <a href="encryption.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-encryption" class="mr-1"></span>Encryption</a>
          <a href="fingerprint.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-fp" class="mr-1"></span>Fingerprinting</a>
          <a href="epssdemo.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-epss" class="mr-1"></span>CVSS vs EPSS</a>
          <a href="dashboard.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-dashboard" class="mr-1"></span>Threat Intel</a>
          <a href="modcat.html" class="flex items-center px-3 py-1 rounded text-blue-300 hover:bg-gray-800 hover:text-white font-semibold transition"><span id="nav-modcat" class="mr-1"></span>PRS MODCAT</a>
        </div>
      </div>
  </nav>

  <!-- Header -->
  <header class="bg-gradient-to-r from-blue-900 to-gray-900 py-10 px-4 text-center shadow-lg">
    <h1 class="text-4xl md:text-5xl font-bold mb-2 text-white tracking-tight">A Practical Guide to SAST False Positives</h1>
    <p class="max-w-2xl mx-auto text-gray-200 text-lg">
      How to investigate common Static Application Security Testing (SAST) findings and determine if they represent a true risk.
    </p>
  </header>

  <main class="flex-1 px-4 py-10 max-w-5xl mx-auto w-full space-y-12">
    
    <!-- SQL Injection Section -->
    <section>
      <div class="flex items-center mb-4">
        <span id="icon-sql" class="text-blue-400 mr-3"></span>
        <h2 class="text-3xl font-semibold text-blue-400">Case Study: SQL Injection in Java/Spring</h2>
      </div>
      <p class="text-gray-200 mb-6">A SAST tool flags a line of code for potential SQL Injection. Here's a checklist to investigate if it's a false positive:</p>
      
      <div class="space-y-6">
        <div>
          <h3 class="text-xl font-semibold text-blue-300 mb-2">1. Trace the Data Source: Is there any user input?</h3>
          <p class="text-gray-300 mb-3">The most crucial question. If the data used in the query is entirely static, hardcoded, or system-generated (e.g., `System.currentTimeMillis()`), it cannot be influenced by a user and is not a vulnerability.</p>
        </div>
        
        <div>
          <h3 class="text-xl font-semibold text-blue-300 mb-2">2. Check for Parameterized Queries (The Right Way)</h3>
          <p class="text-gray-300 mb-3">SAST tools are good, but sometimes they miss the context of modern frameworks. A query that looks like string concatenation might actually be safe if the framework handles parameterization under the hood.</p>
          <p class="font-semibold text-red-400">SAST Flag (Potentially Vulnerable):</p>
          <div class="code-block mt-2 mb-4"><code>String query = "SELECT * FROM users WHERE status = '" + status + "'";</code></div>
          <p class="font-semibold text-green-400">Investigation:</p>
          <ul class="list-disc list-inside text-gray-300 pl-4 mt-2 space-y-2">
            <li><strong>Is it Spring Data JPA?</strong> If the query is defined in a repository interface (e.g., `@Query("...")`), Spring automatically uses parameterized queries for method arguments. This is safe.</li>
            <li><strong>Is it `JdbcTemplate`?</strong> If `JdbcTemplate` is used with `?` placeholders and arguments are passed separately, it is safe. Example: `jdbcTemplate.query(query, new Object[]{status}, ...)`.</li>
          </ul>
        </div>
        
        <div>
          <h3 class="text-xl font-semibold text-blue-300 mb-2">3. Analyze the Input's Constraints: Is the input strictly controlled?</h3>
          <p class="text-gray-300 mb-3">Even if user input is part of a query, the risk can be mitigated if the input is strictly validated against a known-safe allowlist.</p>
           <ul class="list-disc list-inside text-gray-300 pl-4 mt-2 space-y-2">
            <li><strong>Enum Validation:</strong> If the `status` variable from the example above is validated against an Enum (`Status.ACTIVE`, `Status.INACTIVE`), an attacker cannot inject arbitrary values. The query is safe in this context.</li>
            <li><strong>Strict Regex:</strong> If an input must match a rigid pattern (e.g., a 5-digit zip code `^[0-9]{5}$`), the potential for malicious injection is effectively eliminated.</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- HTTPS Section -->
    <section>
      <div class="flex items-center mb-4">
        <span id="icon-http" class="text-blue-400 mr-3"></span>
        <h2 class="text-3xl font-semibold text-blue-400">Case Study: "Traffic is not Encrypted (HTTP)"</h2>
      </div>
      <p class="text-gray-200 mb-6">This is a classic example of a SAST tool lacking architectural context. A tool might see an internal service call like `http://product-service:8080` and flag it, but in modern cloud environments, this is often a false positive.</p>

      <div>
        <h3 class="text-xl font-semibold text-blue-300 mb-2">1. Where is TLS Termination Handled?</h3>
        <p class="text-gray-300 mb-4">In most production systems, encryption is handled outside the application. The application code itself communicates over HTTP within a secure, private network, while an upstream component handles all public-facing HTTPS traffic.</p>
        <div class="text-center p-4 rounded-lg bg-gray-900 border border-gray-800">
            <p class="font-mono text-lg">
                <span class="text-green-400">User (HTTPS)</span> &rarr; 
                <span class="text-blue-400">Load Balancer / Gateway</span> &rarr; 
                <span class="text-yellow-400">Service Mesh / Reverse Proxy</span> &rarr; 
                <span class="text-red-400">Application (HTTP)</span>
            </p>
            <p class="text-sm mt-2 text-gray-400">TLS is terminated at the Load Balancer or Gateway. All internal traffic from that point on is within a trusted network.</p>
        </div>
      </div>

       <div class="mt-6">
        <h3 class="text-xl font-semibold text-blue-300 mb-2">2. How to Verify HTTPS is Enforced</h3>
        <p class="text-gray-300 mb-3">Instead of looking at the code, test the running application's behavior from an external perspective.</p>
         <ul class="list-disc list-inside text-gray-300 pl-4 mt-2 space-y-3">
            <li>
                <strong>Use `curl`:</strong> Run `curl -I http://your-production-site.com`. You should see a `301` or `302` redirect to the `https://` version in the `Location:` header. To follow the redirect, use `curl -IL http://your-production-site.com` and verify the final response is a `200 OK` from the HTTPS URL.
            </li>
             <li>
                <strong>Browser Dev Tools:</strong> Open the Network tab in your browser's developer tools. Type `http://your-production-site.com` into the address bar. The first entry should be a `301` redirect, and all subsequent requests should be to the `https://` version.
            </li>
             <li>
                <strong>Check Infrastructure Configuration:</strong> Review the configuration for your Cloud Load Balancer (GCP, AWS, Azure), Ingress Controller (Kubernetes), or reverse proxy (NGINX) to confirm it is configured to redirect all HTTP traffic to HTTPS.
            </li>
        </ul>
      </div>
    </section>
     <!-- Other Examples Section -->
    <section>
        <div class="flex items-center mb-4">
            <span id="icon-other" class="text-blue-400 mr-3"></span>
            <h2 class="text-3xl font-semibold text-blue-400">Other Common False Positives</h2>
        </div>
        <div class="space-y-6">
            <div>
                <h3 class="text-xl font-semibold text-blue-300 mb-2">Cross-Site Scripting (XSS)</h3>
                <p class="text-gray-300">A SAST tool might flag data being rendered in a template without seeing that the framework provides automatic protection.
                    <br><strong>Investigation:</strong> Is this a modern front-end framework like React, Vue, or Angular? These frameworks automatically escape or sanitize data by default when rendering, mitigating most common XSS risks. The finding is likely a false positive unless `dangerouslySetInnerHTML` or a similar unguarded method is being used.
                </p>
            </div>
            <div>
                <h3 class="text-xl font-semibold text-blue-300 mb-2">Hardcoded Secrets</h3>
                <p class="text-gray-300">Tools are aggressive about finding anything that looks like a key or password.
                    <br><strong>Investigation:</strong> Check the context. Is the flagged "secret" an example key in a comment or documentation? Is it part of a test file using mock or placeholder credentials? Is it a publicly known key for a test environment (e.g., a Stripe public test key)? True positives are secrets that control access to production data or systems.
                </p>
            </div>
        </div>
    </section>

    <!-- File Path Analysis Section -->
    <section>
        <div class="flex items-center mb-4">
            <span id="icon-path" class="text-blue-400 mr-3"></span>
            <h2 class="text-3xl font-semibold text-blue-400">Leveraging File Path Analysis for Triage</h2>
        </div>
        <p class="text-gray-200 mb-6">Before you even start random sampling, you can often eliminate a huge number of findings by analyzing the file paths from your SAST tool's data export. A file's location provides critical context about its role and risk level.</p>
        
        <div class="space-y-6">
            <div>
                <h3 class="text-xl font-semibold text-blue-300 mb-2">1. Identify and Exclude Non-Production Code</h3>
                <p class="text-gray-300 mb-3">Many findings reside in code that is not part of the production application. A quick analysis of the file paths can help you identify and bulk-close these irrelevant alerts.</p>
                <div class="grid md:grid-cols-2 gap-4 mt-4">
                    <div class="bg-gray-900 p-4 rounded-lg border border-gray-800">
                        <h4 class="font-semibold text-blue-300">Test Code</h4>
                        <p class="text-sm text-gray-400">Findings in unit, integration, or end-to-end tests are generally low-risk. Look for common test directories:</p>
                        <ul class="list-disc list-inside text-sm text-gray-300 pl-2 mt-2 font-mono">
                            <li>`src/test/java/` (Java)</li>
                            <li>`tests/`, `__tests__/` (Python, JS)</li>
                            <li>`spec/` (Ruby)</li>
                            <li>`*_test.go` (Go files)</li>
                        </ul>
                    </div>
                    <div class="bg-gray-900 p-4 rounded-lg border border-gray-800">
                        <h4 class="font-semibold text-blue-300">Build & CI/CD Scripts</h4>
                        <p class="text-sm text-gray-400">Code for pipelines might contain test credentials or configurations that are not secrets in a production context.</p>
                        <ul class="list-disc list-inside text-sm text-gray-300 pl-2 mt-2 font-mono">
                            <li>`.github/workflows/`</li>
                            <li>`Jenkinsfile`</li>
                            <li>`azure-pipelines.yml`</li>
                            <li>`scripts/`</li>
                        </ul>
                    </div>
                    <div class="bg-gray-900 p-4 rounded-lg border border-gray-800">
                        <h4 class="font-semibold text-blue-300">Third-Party Libraries</h4>
                        <p class="text-sm text-gray-400">You shouldn't be responsible for fixing findings in vendor code. These should be reported to the vendor and suppressed.</p>
                        <ul class="list-disc list-inside text-sm text-gray-300 pl-2 mt-2 font-mono">
                            <li>`vendor/`</li>
                            <li>`node_modules/`</li>
                            <li>`target/`</li>
                            <li>`build/`</li>
                        </ul>
                    </div>
                    <div class="bg-gray-900 p-4 rounded-lg border border-gray-800">
                        <h4 class="font-semibold text-blue-300">Documentation & Examples</h4>
                        <p class="text-sm text-gray-400">Code in these folders is illustrative and not part of the deployed application.</p>
                        <ul class="list-disc list-inside text-sm text-gray-300 pl-2 mt-2 font-mono">
                            <li>`docs/`</li>
                            <li>`examples/`</li>
                            <li>`samples/`</li>
                            <li>`demo/`</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div>
                <h3 class="text-xl font-semibold text-blue-300 mb-2">2. The Workflow</h3>
                <p class="text-gray-300 mb-3">The process is straightforward and can be done with simple scripts or even spreadsheet software:</p>
                <ol class="list-decimal list-inside text-gray-300 space-y-2">
                    <li><strong>Export All Findings:</strong> Get a complete list from your SAST tool, ensuring the output includes the full file path for each finding. A CSV format is ideal.</li>
                    <li><strong>Filter and Categorize:</strong> Use filtering rules based on the path patterns above to tag each finding. For example, create a new column called "Category" and label findings as "Test", "Build", "Vendor", etc.</li>
                    <li><strong>Prioritize the Rest:</strong> By filtering out these categories, your list of findings is now much smaller and focused exclusively on production source code. You can now apply statistical sampling to this reduced dataset for a more accurate analysis.</li>
                </ol>
            </div>
        </div>
    </section>

    <!-- Statistical Sampling Section -->
    <section>
        <div class="flex items-center mb-4">
            <span id="icon-calc" class="text-blue-400 mr-3"></span>
            <h2 class="text-3xl font-semibold text-blue-400">Tackling High-Volume Findings with Statistical Sampling</h2>
        </div>
        <p class="text-gray-200 mb-6">What if a SAST tool generates thousands of instances of the same finding across a large codebase? Reviewing each one is impractical. Instead, we can use statistical sampling to analyze a smaller subset and make a highly confident, data-driven decision about the entire population.</p>
        
        <div class="grid md:grid-cols-2 gap-8">
            <!-- Calculator -->
            <div class="bg-gray-900 p-6 rounded-xl shadow-lg border border-gray-800">
                <h3 class="text-xl font-semibold text-blue-300 mb-4">Sample Size Calculator</h3>
                <div class="space-y-4">
                    <div>
                        <label for="population" class="block text-sm font-medium text-gray-300">Total Findings (Population Size)</label>
                        <input type="number" id="population" value="1000" class="mt-1 block w-full bg-gray-800 border-gray-700 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label for="confidence" class="block text-sm font-medium text-gray-300">Confidence Level</label>
                        <select id="confidence" class="mt-1 block w-full bg-gray-800 border-gray-700 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                            <option value="1.96" selected>95% (Standard)</option>
                            <option value="1.645">90%</option>
                            <option value="2.576">99%</option>
                        </select>
                    </div>
                    <div>
                        <label for="margin" class="block text-sm font-medium text-gray-300">Margin of Error</label>
                        <select id="margin" class="mt-1 block w-full bg-gray-800 border-gray-700 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                            <option value="0.05" selected>5% (Standard)</option>
                            <option value="0.01">1%</option>
                            <option value="0.1">10%</option>
                        </select>
                    </div>
                </div>
                <div class="mt-6 bg-blue-900/50 border border-blue-700 text-blue-200 px-4 py-3 rounded-lg text-center">
                    <p class="text-sm font-medium">Required Sample Size to Review:</p>
                    <p id="sample-size" class="text-3xl font-bold mt-1">278</p>
                </div>
            </div>

            <!-- Methodology -->
            <div class="text-gray-300">
                <h3 class="text-xl font-semibold text-blue-300 mb-2">The Approach</h3>
                <ol class="list-decimal list-inside space-y-3">
                    <li>
                        <strong>Define Your Parameters:</strong> Use the calculator to determine your sample size. A 95% confidence level with a 5% margin of error is a common industry standard. This means you can be 95% sure that the results from your sample reflect the entire set of findings, plus or minus 5%.
                    </li>
                    <li>
                        <strong>Select a Random Sample:</strong> Export the list of all findings. Use a script or even a spreadsheet's random function to select the required number of findings randomly. It is critical that the sample is random and not just the "first N" findings.
                    </li>
                    <li>
                        <strong>Analyze the Sample:</strong> Manually investigate each finding in your random sample, classifying it as a "True Positive" or "False Positive" based on the techniques described on this page.
                    </li>
                    <li>
                        <strong>Extrapolate the Results:</strong> Calculate the false positive rate from your sample. For example, if you reviewed 278 findings and found that 270 were false positives, your false positive rate is ~97%.
                    </li>
                    <li>
                        <strong>Make an Informed Decision:</strong> With a high false positive rate (e.g., >95%) backed by statistical data, you can now confidently recommend closing all findings of this type with a clear justification. This saves hundreds of hours of developer and security time.
                    </li>
                </ol>
            </div>
        </div>
    </section>

  </main>
  
  <footer class="bg-gray-900 text-gray-400 text-center py-4 mt-8 rounded-t-xl shadow-inner">
    Â© 2025 D. Chandler Prince
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      lucide.createIcons({
        icons: {
          'nav-linkedin': lucide.Linkedin, 'nav-github': lucide.Github, 'nav-home': lucide.Home, 'nav-threat': lucide.ShieldAlert, 'nav-checklist': lucide.ListChecks, 'nav-jwt': lucide.KeyRound, 'nav-fp': lucide.Fingerprint, 'nav-epss': lucide.Activity, 'nav-dashboard': lucide.LayoutDashboard, 'nav-sast': lucide.FileSearch,
          'icon-sql': lucide.Database,
          'icon-http': lucide.Server,
          'icon-other': lucide.ListChecks,
          'icon-calc': lucide.Calculator,
          'icon-path': lucide.FileCode
        },
        attrs: { color: "#38bdf8", size: 32, strokeWidth: 2 }
      });

      // --- Sample Size Calculator Logic ---
      const populationEl = document.getElementById('population');
      const confidenceEl = document.getElementById('confidence');
      const marginEl = document.getElementById('margin');
      const sampleSizeEl = document.getElementById('sample-size');

      const calculateSampleSize = () => {
        const N = parseInt(populationEl.value);
        const Z = parseFloat(confidenceEl.value); // Z-score
        const e = parseFloat(marginEl.value); // Margin of error
        const p = 0.5; // Use 0.5 for the most conservative sample size

        if (isNaN(N) || N <= 0) {
            sampleSizeEl.textContent = "N/A";
            return;
        }

        // Cochran's formula for sample size
        const n0 = (Z * Z * p * (1 - p)) / (e * e);
        
        // Correction for finite population
        const n = n0 / (1 + (n0 - 1) / N);

        sampleSizeEl.textContent = Math.ceil(n);
      };
      
      populationEl.addEventListener('input', calculateSampleSize);
      confidenceEl.addEventListener('change', calculateSampleSize);
      marginEl.addEventListener('change', calculateSampleSize);

      // Initial calculation on page load
      calculateSampleSize();
    });
  </script>
</body>
</html>


